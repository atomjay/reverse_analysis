# 05_combined_protections: 綜合保護與逆向

## 目標
將上述所有保護技術應用到一個程式上，並學習如何制定一個綜合性的逆向策略來逐步解除多層保護。

## 原始程式碼
`original_program.c` 將是一個包含複雜邏輯的 C 程式碼。

## 綜合保護步驟
1. 編譯 `original_program.c`。
2. 應用符號移除 (`strip`)。
3. 應用程式碼混淆 (例如 `ollvm` 或手動混淆)。
4. 應用自定義加密打包。
5. 最後應用 UPX 加殼。

## 逆向策略
1. **層次化分析:** 從最外層的保護開始（通常是加殼），逐步解除。
2. **識別保護類型:** 使用工具（如 `DIE`、`strings`、`file`）識別每一層的保護類型。
3. **解除外層保護:**
    *   如果檢測到 UPX，嘗試 `upx -d` 或手動解殼。
    *   如果檢測到自定義加密打包，分析解密存根，動態轉儲解密後的程式碼。
4. **靜態分析 (IDA Pro / Hopper):** 每解除一層保護後，將中間文件載入 IDA Pro 或 Hopper 進行靜態分析，理解其結構和邏輯。
5. **動態偵錯 (LLDB):** 結合動態偵錯來驗證靜態分析的結果，追蹤程式執行流程和數據流。
6. **去混淆與符號恢復:** 在解除加殼和加密後，針對混淆的程式碼進行去混淆，並嘗試透過分析恢復部分符號信息。

## 工具
*   `clang` (編譯器)
*   `upx` (加殼工具)
*   `strip` (符號移除工具)
*   `openssl` (加密工具)
*   `ollvm` (或類似的混淆編譯器)
*   `r2` (Radare2，靜態分析)
*   `lldb` (動態偵錯)
*   `IDA Pro` 或 `Hopper` (專業靜態分析工具)
